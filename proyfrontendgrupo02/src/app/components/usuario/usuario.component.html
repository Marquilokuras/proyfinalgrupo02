<div class="container">
  <h2>Gestion de Usuarios</h2>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Nombre</th>
          <th scope="col">Apellido</th>
          <th scope="col">Email</th>
          <th scope="col">DNI</th>
          <th scope="col">Edad</th>
          <th scope="col">Tipo de Usuario</th>
          <th scope="col">Opciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let usuario of listUsuario">
          <td>{{usuario.nombre}}</td>
          <td>{{usuario.apellido}}</td>
          <td>{{usuario.email}}</td>
          <td>{{usuario.dniUsuario}}</td>
          <td>{{usuario.edadUsuario}}</td>
          <td>{{usuario.tipoUsuario}}</td>
          <td>
            <button type="button" class="btn btn-primary" style="margin-right: 10px"
              (click)="modificarUsuario(usuario._id)"><i class="fa-solid fa-pencil"></i></button>
            <button type="button" class="btn btn-danger" (click)="eliminarUsuario(usuario._id)"><i
                class="fa-sharp fa-solid fa-trash"></i></button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <button type="button" class="btn btn-primary" (click)="agregarUsuario()">Agregar Usuario</button>
</div>

<br>

<div class="container" *ngIf="usuarioNuevo===true">
  <h2>Registrar</h2>
  <form name="registerForm" class="register-form" #registrarForm="ngForm">
    <div class="form-group">
      <label for="email">Email</label>
      <div class="input-group">
        <div class="input-group-text">@</div>
        <input type="email" class="form-control" name="registerNombre" placeholder="Ingrese Email"
          [(ngModel)]="emailUsuario" required />

      </div>
    </div>
    <div class="form-group">
      <label for="registerNombre">Passaword</label>
      <input type="password" class="form-control" name="registerNombre" placeholder="Ingrese Password"
        [(ngModel)]="passwordUsuario" required />

    </div>

    <div class="form-group">
      <label for="registerNombre">Nombre</label>
      <input type="text" class="form-control" name="registerNombre" placeholder="Ingrese Nombre Completo"
        [(ngModel)]="nombreUsuario" required />

    </div>

    <div class="form-group">
      <label for="registerApellido">Apellido</label>
      <input type="text" class="form-control" name="registerApellido" placeholder="Ingrese Apellido Completo"
        [(ngModel)]="apellidoUsuario" required pattern="[A-Za-záéíóúÁÉÍÓÚñÑ\s]+" #apellido="ngModel" />
      <div *ngIf="apellido.invalid && (apellido.dirty || apellido.touched)" class="alert alert-danger">
        <div *ngIf="apellido.errors?.['required']">
          El apellido es requerido
        </div>
        <div *ngIf="apellido.errors?.['pattern']">
          El apellido solo puede contener letras y espacios.
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="registerDni">DNI</label>
      <input type="text" class="form-control" name="registerDni" placeholder="Ingrese DNI" [(ngModel)]="dniUsuario"
        required pattern="[0-9]+" #dni="ngModel" />
      <div *ngIf="dni.invalid && (dni.dirty || dni.touched)" class="alert alert-danger">
        <div *ngIf="dni.errors?.['required']">
          El DNI es requerido
        </div>
        <div *ngIf="dni.errors?.['pattern']">
          El DNI debe ser un número válido.
        </div>
      </div>
    </div>


    <div class="form-group">
      <label for="registerEdad">Edad</label>
      <input type="number" class="form-control" name="registerEdad" placeholder="Ingrese Edad" [(ngModel)]="edadUsuario"
        required min="16" max="110" #edad="ngModel" />
      <div *ngIf="edad.invalid && (edad.dirty || edad.touched)" class="alert alert-danger">
        <div *ngIf="edad.errors?.['required']">
          La edad es requerida
        </div>
        <div *ngIf="edad.errors?.['min'] || edad.errors?.['max']">
          La edad debe estar entre 16 y 110 años
        </div>
      </div>
    </div>

    <div class="mb-3 form-check">
      <label for="tipo" class="form-label">Tipo de Usuario</label>
      <select class="form-select" aria-label="Default select example" id="tipo" name="tipo"
        [(ngModel)]="tipoUsuarioCliente" required #tipo="ngModel">
        <option value="cliente">Cliente</option>
        <option value="gestor">Gestor</option>
        <option value="administrador">Administrador</option>
      </select>
      <div *ngIf="tipo.invalid && (tipo.dirty || tipo.touched)" class="alert alert-danger">
        <div *ngIf="tipo.errors?.['required']">
          El tipo de usuario es requerido
        </div>
      </div>
    </div>

    <br>
    <div class="form-group">
      <button class="btn btn-primary btn-block" (click)="altaUsuarioCliente()"
        [disabled]="!registrarForm.form.valid">Registrar</button>
      <button class="btn btn-danger btn-block" (click)="cancelar()">Cancelar</button>
    </div>
  </form>
</div>